use billing;
db.createCollection('log');
db.createCollection('lines');
db.createCollection('billrun');
db.createCollection('events');
db.createCollection('accounts');

// Add indecies to insure that theres no duplicate lines.
db.lines.ensureIndex({'stamp': 1 }, { unique: true });
db.log.ensureIndex({'stamp': 1 },  { unique: true , sparse: true});

// Add indecies to  increase access speeds to lines collection.
db.lines.ensureIndex({'billrun': 1 }, { unique: false, sparse: true, background: true});
db.lines.ensureIndex({'subscriber_id': 1 }, { unique: false, sparse: true, background: true });

//08/Jan/2013
db.billrun.ensureIndex({'account_id': 1 }, { unique: false, sparse: true, background: true});
db.billrun.ensureIndex({'stamp': 1 }, { unique: false, sparse: true, background: true});
db.lines.ensureIndex({'price_customer': 1, 'price_provider' : 1 }, { unique: false, sparse: true, background: true});

//23/Jan/2013
db.lines.ensureIndex({'type': 1 }, { unique: false , sparse: true, background: true });
db.lines.ensureIndex({'source': 1 }, { unique: false , sparse: true, background: true });
db.lines.ensureIndex({'price_customer': 1 }, { unique: false, sparse: true, background: true});

//29/Jan/2013
db.log.ensureIndex({'type': 1 }, { unique: false , sparse: true, background: true });
db.log.ensureIndex({'source': 1 }, { unique: false , sparse: true, background: true });

//13/Feb/2013 to speed up alert aggregate
db.lines.ensureIndex({'deposit_stamp': 1 }, { unique: false , sparse: true, background: true });
db.lines.ensureIndex({'event_stamp': 1 }, { unique: false , sparse: true, background: true });

//19/Mar/2013 create collection for rates
db.createCollection('rates');

//20/Apr/2013 fatster reports queries 
db.lines.ensureIndex({'record_type': 1 }, { unique: false , sparse: true, background: true });
db.lines.ensureIndex({'unified_record_time': 1 }, { unique: false , sparse: true, background: true })

//22/Apr/2013 create index for imsi
db.lines.ensureIndex({'imsi': 1 }, { unique: false, sparse: true, background: true});

//29/Mar/2013 create rates indexes
db.rates.ensureIndex({'from': 1, 'to': 1, 'destinations': 1 }, { unique: true, sparse: true, background: true });
db.rates.ensureIndex({'from': 1 }, { unique: false , sparse: true, background: true });
db.rates.ensureIndex({'to': 1 }, { unique: false , sparse: true, background: true });
db.rates.ensureIndex({'destinations': 1 }, { unique: false , sparse: true, background: true });
db.rates.ensureIndex({'key': 1 }, { unique: false , sparse: true, background: true });

//20/Mar/2013 add plan to DB
db.plans.insert({from:ISODate('2013-01-30T00:00:00Z'),to:null,name:'LARGE',include:{call:'UNLIMITED',sms:'UNLIMITED',mms:'UNLIMITED',data:'UNLIMITED'}})
db.plans.insert({from:ISODate('2013-01-30T00:00:00Z'),to:null,name:'SMALL',include:{call:'3600',sms:'60',data:'1000000000'}})
//db.plans.insert({from:ISODate('2013-05-30T00:00:00Z'),to:null,name:'BIRTHDAY',include:{call:'UNLIMITED',sms:'UNLIMITED',data:'0',international_call:0, international_sms:0}})